
SET SCHEMA 'estoque_aud';
-----------------
------ AUDITORIA
-----------------

CREATE SEQUENCE IF NOT EXISTS REVINFO_SEQ AS BIGINT start 
with 
   1 INCREMENT BY 1 MINVALUE 1;

CREATE TABLE IF NOT EXISTS REVINFO (
  id integer not null, timestamp bigint, estoque varchar(255), primary key (id));

--[TABLE: ESTOQUE]

CREATE TABLE IF NOT EXISTS TB_ESTOQUE_AUD AS TABLE estoque.TB_ESTOQUE 
WITH NO DATA;

ALTER TABLE TB_ESTOQUE_AUD ADD COLUMN REV INTEGER NOT NULL;
ALTER TABLE TB_ESTOQUE_AUD ADD COLUMN REVTYPE SMALLINT;

--[CONSTRAINT]
ALTER TABLE TB_ESTOQUE_AUD
  ADD CONSTRAINT TB_ESTOQUE_AUD_FK_REVINFO FOREIGN KEY (REV) REFERENCES REVINFO (ID);